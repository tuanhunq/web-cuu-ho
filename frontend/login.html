<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ Thống Cứu Hộ Quốc Gia</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="assets/css/styles.css">
    <style>
        .dropdown-menu {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-radius: 8px;
            z-index: 1000;
            overflow: hidden;
        }
        
        .dropdown-menu.show {
            display: block;
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #4b5563;
            text-decoration: none;
            transition: all 0.2s;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .dropdown-item:hover {
            background-color: #f9fafb;
            color: #1f2937;
        }
        
        .dropdown-item i {
            margin-right: 8px;
            width: 16px;
            height: 16px;
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f59e0b, #ef4444);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .role-badge {
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 8px;
        }
        
        .role-user {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .role-rescuer {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .role-admin {
            background-color: #fef3c7;
            color: #92400e;
        }
    </style>
</head>
<body class="bg-gray-50">
   <!-- Navigation -->
<nav id="navbar" class="shadow-md sticky top-0 z-50 transition-all duration-300">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-20 items-center">
            <div class="flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                </svg>
                <span class="text-2xl font-bold bg-gradient-to-r from-red-500 to-orange-500 bg-clip-text text-transparent">CỨU HỘ QUỐC GIA</span>
            </div>
            <div class="hidden md:flex items-center space-x-8">
                <a href="adminindex.html" class="nav-link text-red-500 font-bold transition">Trang chủ</a>
                <a href="adminmap.html" class="nav-link text-gray-700 hover:text-red-500 font-medium transition">Bản đồ cứu hộ</a>
                <a href="adminrequest.html" class="nav-link text-gray-700 hover:text-red-500 font-medium transition">Bản tin</a>
                <a href="adminposst.html" class="nav-link text-gray-700 hover:text-red-500 font-medium transition">Báo tin</a>
                <div class="flex space-x-4">
                    <a href="admin.html" class="bg-gray-800 hover:bg-gray-900 text-white px-4 py-2 rounded-lg font-medium transition-all shadow hover:shadow-lg">Admin</a>
                    
                    <!-- Phần tài khoản người dùng -->
                    <div class="relative">
                        <button id="user-menu-btn" class="flex items-center bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white px-4 py-2 rounded-lg font-medium transition-all shadow hover:shadow-lg">
                            <div id="user-avatar" class="user-avatar">?</div>
                            <span id="user-name">Tài khoản</span>
                            <span id="user-role" class="role-badge role-user ml-2">Người dùng</span>
                            <i data-feather="chevron-down" class="ml-2 w-4 h-4"></i>
                        </button>
                        
                        <div id="user-dropdown" class="dropdown-menu">
                            <div class="px-4 py-3 border-b">
                                <div class="font-medium" id="dropdown-user-name">Tài khoản</div>
                                <div class="text-sm text-gray-500" id="dropdown-user-email">Chưa đăng nhập</div>
                            </div>
                            <a href="profile.html" class="dropdown-item">
                                <i data-feather="user"></i>
                                Hồ sơ cá nhân
                            </a>
                            <a href="settings.html" class="dropdown-item">
                                <i data-feather="settings"></i>
                                Cài đặt
                            </a>
                            <a href="my-requests.html" class="dropdown-item">
                                <i data-feather="list"></i>
                                Yêu cầu của tôi
                            </a>
                            <div id="admin-menu" class="hidden">
                                <div class="border-t"></div>
                                <a href="admin.html" class="dropdown-item">
                                    <i data-feather="shield"></i>
                                    Quản trị hệ thống
                                </a>
                                <a href="user-management.html" class="dropdown-item">
                                    <i data-feather="users"></i>
                                    Quản lý người dùng
                                </a>
                            </div>
                            <div id="rescuer-menu" class="hidden">
                                <div class="border-t"></div>
                                <a href="rescuer-dashboard.html" class="dropdown-item">
                                    <i data-feather="activity"></i>
                                    Bảng điều khiển cứu hộ
                                </a>
                                <a href="rescuer-missions.html" class="dropdown-item">
                                    <i data-feather="target"></i>
                                    Nhiệm vụ của tôi
                                </a>
                            </div>
                            <div class="border-t"></div>
                            <a href="#" id="login-btn" class="dropdown-item">
                                <i data-feather="log-in"></i>
                                Đăng nhập
                            </a>
                            <a href="#" id="logout-btn" class="dropdown-item hidden text-red-500">
                                <i data-feather="log-out"></i>
                                Đăng xuất
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="md:hidden flex items-center">
                <button id="menu-toggle" class="text-gray-700 hover:text-red-600" aria-label="Toggle menu">
                    <i data-feather="menu"></i>
                </button>
            </div>
        </div>
    </div>
    <div id="mobile-menu" class="hidden md:hidden bg-white py-2 px-4 shadow-lg">
        <a href="index.html#home" class="block py-2 text-gray-700 hover:text-red-600 transition">Trang chủ</a>
        <a href="map.html" class="block py-2 text-gray-700 hover:text-red-600 transition">Bản đồ cứu hộ</a>
        <a href="request.html" class="block py-2 text-red-600 font-bold transition">Bản tin</a>
        <a href="post.html#report" class="block py-2 text-gray-700 hover:text-red-600 transition">Báo tin</a>
        
        <!-- Menu tài khoản cho mobile -->
        <div class="border-t pt-2 mt-2">
            <div class="flex items-center py-2">
                <div id="mobile-user-avatar" class="user-avatar">?</div>
                <div>
                    <span id="mobile-user-name" class="font-medium">Tài khoản</span>
                    <span id="mobile-user-role" class="role-badge role-user ml-2">Người dùng</span>
                </div>
            </div>
            <a href="profile.html" class="block py-2 text-gray-700 hover:text-red-600 transition">
                <i data-feather="user" class="inline w-4 h-4 mr-2"></i>
                Hồ sơ cá nhân
            </a>
            <a href="settings.html" class="block py-2 text-gray-700 hover:text-red-600 transition">
                <i data-feather="settings" class="inline w-4 h-4 mr-2"></i>
                Cài đặt
            </a>
            <a href="my-requests.html" class="block py-2 text-gray-700 hover:text-red-600 transition">
                <i data-feather="list" class="inline w-4 h-4 mr-2"></i>
                Yêu cầu của tôi
            </a>
            <div id="mobile-admin-menu" class="hidden">
                <a href="admin.html" class="block py-2 text-gray-700 hover:text-red-600 transition">
                    <i data-feather="shield" class="inline w-4 h-4 mr-2"></i>
                    Quản trị hệ thống
                </a>
                <a href="user-management.html" class="block py-2 text-gray-700 hover:text-red-600 transition">
                    <i data-feather="users" class="inline w-4 h-4 mr-2"></i>
                    Quản lý người dùng
                </a>
            </div>
            <div id="mobile-rescuer-menu" class="hidden">
                <a href="rescuer-dashboard.html" class="block py-2 text-gray-700 hover:text-red-600 transition">
                    <i data-feather="activity" class="inline w-4 h-4 mr-2"></i>
                    Bảng điều khiển cứu hộ
                </a>
                <a href="rescuer-missions.html" class="block py-2 text-gray-700 hover:text-red-600 transition">
                    <i data-feather="target" class="inline w-4 h-4 mr-2"></i>
                    Nhiệm vụ của tôi
                </a>
            </div>
            <a href="#" id="mobile-login-btn" class="block py-2 text-blue-600 font-medium transition">
                <i data-feather="log-in" class="inline w-4 h-4 mr-2"></i>
                Đăng nhập
            </a>
            <a href="#" id="mobile-logout-btn" class="block py-2 text-red-500 font-medium transition hidden">
                <i data-feather="log-out" class="inline w-4 h-4 mr-2"></i>
                Đăng xuất
            </a>
        </div>
    </div>
</nav>

<!-- Hero Section -->
<section id="home" class="hero-section py-20 min-h-[80vh]" style="background-image: url('https://www.tapchicongsan.org.vn/image/journal/article?img_id=114021286&t=1622418445678'); background-size: cover; background-position: center; position: relative;">
    <div class="absolute inset-0 bg-black opacity-50" style="z-index: 1;"></div> <!-- Overlay mờ hơn để tăng thẩm mỹ và dễ đọc -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative" style="z-index: 2;">
        <div class="flex flex-col md:flex-row items-center">
            <div class="md:w-1/2 mb-10 md:mb-0">
                <h1 class="text-4xl md:text-5xl font-bold leading-tight mb-6">
                    <span class="bg-gradient-to-r from-red-500 to-orange-500 bg-clip-text text-transparent">Hệ Thống Cứu Hộ</span> <br>
                    
                </h1>
                <p class="text-lg text-white mb-8 max-w-lg leading-relaxed"> <!-- Thay text-gray-600 thành text-white để thẩm mỹ hơn -->
                    Kết nối người dân với lực lượng cứu hộ trong các tình huống khẩn cấp như thiên tai, hỏa hoạn, tai nạn giao thông và các sự cố đe dọa tính mạng.
                </p>
                <div class="flex space-x-4">
                    <a href="adminposst.html" class="emergency-btn bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white px-6 py-3 rounded-lg font-medium transition-all shadow-lg flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                        BÁO TIN
                    </a>
                    <a href="adminmap.html" class="border-2 border-red-500 text-red-500 hover:bg-red-50 px-6 py-3 rounded-lg font-medium transition-all shadow flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>  
                        XEM BẢN ĐỒ
                    </a>
                </div>
            </div>  
        </div>
    </div>
</section>

<!-- Demo User Selection -->
<section class="py-8 bg-white">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-gray-50 rounded-xl p-6 border border-gray-200">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Demo: Chọn loại tài khoản để xem</h3>
            <p class="text-gray-600 mb-4">Chọn một loại tài khoản để xem cách phần tài khoản thay đổi theo vai trò người dùng:</p>
            <div class="flex flex-wrap gap-3">
                <button id="demo-guest" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg transition">
                    Khách (Chưa đăng nhập)
                </button>
                <button id="demo-user" class="bg-blue-100 hover:bg-blue-200 text-blue-800 px-4 py-2 rounded-lg transition">
                    Người dùng thường
                </button>
                <button id="demo-rescuer" class="bg-green-100 hover:bg-green-200 text-green-800 px-4 py-2 rounded-lg transition">
                    Người cứu hộ
                </button>
                <button id="demo-admin" class="bg-yellow-100 hover:bg-yellow-200 text-yellow-800 px-4 py-2 rounded-lg transition">
                    Quản trị viên
                </button>
            </div>
        </div>
    </div>
</section>

<!-- Rest of the page content remains the same -->
<!-- ... -->

    <!-- Scripts -->
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js"></script>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/map.js"></script>
    <script src="assets/js/auth-manager.js"></script>   
    <script src="assets/js/user-manager.js"></script>
    <script src="assets/js/security-manager.js"></script>
    
    <script>
        // Hàm để cập nhật giao diện người dùng dựa trên thông tin tài khoản
        function updateUserInterface(user) {
            // Các phần tử DOM
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-name');
            const userRole = document.getElementById('user-role');
            const dropdownUserName = document.getElementById('dropdown-user-name');
            const dropdownUserEmail = document.getElementById('dropdown-user-email');
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const adminMenu = document.getElementById('admin-menu');
            const rescuerMenu = document.getElementById('rescuer-menu');
            
            // Các phần tử mobile
            const mobileUserAvatar = document.getElementById('mobile-user-avatar');
            const mobileUserName = document.getElementById('mobile-user-name');
            const mobileUserRole = document.getElementById('mobile-user-role');
            const mobileLoginBtn = document.getElementById('mobile-login-btn');
            const mobileLogoutBtn = document.getElementById('mobile-logout-btn');
            const mobileAdminMenu = document.getElementById('mobile-admin-menu');
            const mobileRescuerMenu = document.getElementById('mobile-rescuer-menu');
            
            if (user) {
                // Người dùng đã đăng nhập
                userAvatar.textContent = user.avatar || user.name.charAt(0).toUpperCase();
                userName.textContent = user.name;
                dropdownUserName.textContent = user.name;
                dropdownUserEmail.textContent = user.email || 'Đã đăng nhập';
                
                // Mobile
                mobileUserAvatar.textContent = user.avatar || user.name.charAt(0).toUpperCase();
                mobileUserName.textContent = user.name;
                
                // Cập nhật vai trò
                updateRoleDisplay(user.role, userRole, mobileUserRole);
                
                // Hiển thị menu theo vai trò
                if (user.role === 'admin') {
                    adminMenu.classList.remove('hidden');
                    mobileAdminMenu.classList.remove('hidden');
                    rescuerMenu.classList.add('hidden');
                    mobileRescuerMenu.classList.add('hidden');
                } else if (user.role === 'rescuer') {
                    rescuerMenu.classList.remove('hidden');
                    mobileRescuerMenu.classList.remove('hidden');
                    adminMenu.classList.add('hidden');
                    mobileAdminMenu.classList.add('hidden');
                } else {
                    adminMenu.classList.add('hidden');
                    mobileAdminMenu.classList.add('hidden');
                    rescuerMenu.classList.add('hidden');
                    mobileRescuerMenu.classList.add('hidden');
                }
                
                // Hiển thị nút đăng xuất, ẩn nút đăng nhập
                loginBtn.classList.add('hidden');
                logoutBtn.classList.remove('hidden');
                mobileLoginBtn.classList.add('hidden');
                mobileLogoutBtn.classList.remove('hidden');
            } else {
                // Người dùng chưa đăng nhập
                userAvatar.textContent = '?';
                userName.textContent = 'Tài khoản';
                dropdownUserName.textContent = 'Tài khoản';
                dropdownUserEmail.textContent = 'Chưa đăng nhập';
                
                // Mobile
                mobileUserAvatar.textContent = '?';
                mobileUserName.textContent = 'Tài khoản';
                
                // Vai trò mặc định
                updateRoleDisplay('guest', userRole, mobileUserRole);
                
                // Ẩn các menu đặc quyền
                adminMenu.classList.add('hidden');
                rescuerMenu.classList.add('hidden');
                mobileAdminMenu.classList.add('hidden');
                mobileRescuerMenu.classList.add('hidden');
                
                // Hiển thị nút đăng nhập, ẩn nút đăng xuất
                loginBtn.classList.remove('hidden');
                logoutBtn.classList.add('hidden');
                mobileLoginBtn.classList.remove('hidden');
                mobileLogoutBtn.classList.add('hidden');
            }
        }
        
        // Hàm cập nhật hiển thị vai trò
        function updateRoleDisplay(role, desktopElement, mobileElement) {
            // Xóa tất cả các lớp vai trò cũ
            desktopElement.classList.remove('role-user', 'role-rescuer', 'role-admin');
            mobileElement.classList.remove('role-user', 'role-rescuer', 'role-admin');
            
            // Thêm lớp vai trò mới và cập nhật văn bản
            switch(role) {
                case 'user':
                    desktopElement.textContent = 'Người dùng';
                    mobileElement.textContent = 'Người dùng';
                    desktopElement.classList.add('role-user');
                    mobileElement.classList.add('role-user');
                    break;
                case 'rescuer':
                    desktopElement.textContent = 'Cứu hộ';
                    mobileElement.textContent = 'Cứu hộ';
                    desktopElement.classList.add('role-rescuer');
                    mobileElement.classList.add('role-rescuer');
                    break;
                case 'admin':
                    desktopElement.textContent = 'Quản trị';
                    mobileElement.textContent = 'Quản trị';
                    desktopElement.classList.add('role-admin');
                    mobileElement.classList.add('role-admin');
                    break;
                default:
                    desktopElement.textContent = 'Khách';
                    mobileElement.textContent = 'Khách';
                    desktopElement.classList.add('role-user');
                    mobileElement.classList.add('role-user');
            }
        }
        
        // Dữ liệu người dùng mẫu
        const demoUsers = {
            guest: null,
            user: {
                name: 'Nguyễn Văn A',
                email: 'nguyenvana@example.com',
                role: 'user',
                avatar: 'NA'
            },
            rescuer: {
                name: 'Trần Thị B',
                email: 'tranthib@example.com',
                role: 'rescuer',
                avatar: 'TB'
            },
            admin: {
                name: 'Lê Văn C',
                email: 'levanc@example.com',
                role: 'admin',
                avatar: 'LC'
            }
        };
        
        // Khởi tạo với trạng thái khách
        let currentUser = demoUsers.guest;
        updateUserInterface(currentUser);
        
        // Xử lý sự kiện khi DOM đã tải xong
        document.addEventListener('DOMContentLoaded', function() {
            // Khởi tạo feather icons
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
            
            // Xử lý dropdown menu cho tài khoản
            const userMenuBtn = document.getElementById('user-menu-btn');
            const userDropdown = document.getElementById('user-dropdown');
            
            if (userMenuBtn && userDropdown) {
                userMenuBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    userDropdown.classList.toggle('show');
                });
                
                // Đóng dropdown khi click ra ngoài
                document.addEventListener('click', function() {
                    userDropdown.classList.remove('show');
                });
            }
            
            // Xử lý đăng nhập/đăng xuất
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const mobileLoginBtn = document.getElementById('mobile-login-btn');
            const mobileLogoutBtn = document.getElementById('mobile-logout-btn');
            
            if (loginBtn) {
                loginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Mở modal đăng nhập hoặc chuyển hướng đến trang đăng nhập
                    window.location.href = 'login.html';
                });
            }
            
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Đăng xuất
                    currentUser = demoUsers.guest;
                    updateUserInterface(currentUser);
                    alert('Đã đăng xuất thành công!');
                });
            }
            
            if (mobileLoginBtn) {
                mobileLoginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Mở modal đăng nhập hoặc chuyển hướng đến trang đăng nhập
                    window.location.href = 'login.html';
                });
            }
            
            if (mobileLogoutBtn) {
                mobileLogoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Đăng xuất
                    currentUser = demoUsers.guest;
                    updateUserInterface(currentUser);
                    alert('Đã đăng xuất thành công!');
                });
            }
            
            // Xử lý demo chọn tài khoản
            document.getElementById('demo-guest').addEventListener('click', function() {
                currentUser = demoUsers.guest;
                updateUserInterface(currentUser);
            });
            
            document.getElementById('demo-user').addEventListener('click', function() {
                currentUser = demoUsers.user;
                updateUserInterface(currentUser);
            });
            
            document.getElementById('demo-rescuer').addEventListener('click', function() {
                currentUser = demoUsers.rescuer;
                updateUserInterface(currentUser);
            });
            
            document.getElementById('demo-admin').addEventListener('click', function() {
                currentUser = demoUsers.admin;
                updateUserInterface(currentUser);
            });
        });
    </script>
</body>
</html>